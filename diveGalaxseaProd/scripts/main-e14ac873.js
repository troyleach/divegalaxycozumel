var HEADERS={headers:{Authorization:'Token "b32b59ec8d08206981481033e1d6cac3"'}},URL="http://localhost:3005/",WEATHER_URL="http://api.worldweatheronline.com/free/v2/weather.ashx?q=20.511138%2C-86.949234&format=json&num_of_days=5&key=91e6dc741ca2f99fa18e1408ee471",WEATHER_MARINE_URL="http://api.worldweatheronline.com/free/v2/marine.ashx?q=20.511138%2C-86.949234&format=json&key=91e6dc741ca2f99fa18e1408ee471",DARK_SKY_KEY="https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/",DARK_SKY_API_KEY="3ee0827e37914db0145083537581604b",DB_ACCESS_TOKEN="TfMIrZsh-ycAAAAAAAATcMf8xXvVLFp70DVpuXjpO8PUFuEwup2fSYv0lBAt7L8C",AWS_ACCESS_KEY="AKIAIGEIVLW35DWOI4XQ",AWS_SECRET_ACCESS_KEY="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",AWS_REGION="us-west-2";!function(){"use strict";var e=angular.module("myApp",["ngRoute","myApp.utilityService","myApp.constants","myApp.directives","myApp.filters","myApp.services","myApp.controller","ngSanitize","jkuri.gallery","ngAnimate","ui.bootstrap","gm.datepickerMultiSelect","ui.mask","checklist-model","angularSpinner","ngIntlTelInput"]);e.config(["ngIntlTelInputProvider",function(e){e.set({defaultCountry:"us"})}]),e.config(["$routeProvider",function(e){e.when("/admin",{templateUrl:"partials/admin.html",controller:"AdminCtrl",controllerAs:"admin",resolve:{auth:["$q","AuthenticationService","$location",function(e,r,t){var n=r.getUserInfo();return n?e.when(n):(window.localStorage.alerts="Not a Authorized Diver",window.localStorage.alertType="alert-danger",t.path("/home"),e.reject({authenticated:!1}))}]}}),e.when("/home",{templateUrl:"partials/home.html",controller:"HomeCtrl",controllerAs:"home"}),e.when("/reef_map",{templateUrl:"partials/reef_map.html",controller:"ReefMapCtrl",controllerAs:"reefMap"}),e.when("/current_pricing",{templateUrl:"partials/current_pricing.html",controller:"CurrentPricingCtrl",controllerAs:"pricing"}),e.when("/about_cozumel",{templateUrl:"partials/about_cozumel.html",controller:"AboutCozumelCtrl",controllerAs:"aboutCozumel"}),e.when("/gallery",{templateUrl:"partials/gallery.html",controller:"GalleryCtrl",controllerAs:"gallery"}),e.when("/reservations",{templateUrl:"partials/reservations.html",controller:"ReservationsCtrl",controllerAs:"reservation"}),e.otherwise({redirectTo:"/home"})}]),e.run(["$rootScope","$location",function(e,r){e.$on("$routeChangeSuccess",function(e){console.log(e)}),e.$on("$routeChangeError",function(e,t,n,i){i.authenticated===!1&&(console.log("Route change Error"),r.path("/login"))})}])}(),function(){"use strict";var e=angular.module("myApp.controller",[]);e.controller("IndexCtrl",["$scope","getWeatherFactory","$uibModal","AuthenticationService","$location","$window","$http","getImagesFactory",function(e,r,t,n,i,o,s,c){function a(e){var r=new Date(e),t=["Sun","Mon","Tue","Wed","Thur","Fri","Sat"],n=t[r.getUTCDay()];return n}var l=this;l.date=new Date,l.tempScale=!0,l.tripAdvisorReview=["You looking for a great, custom experience rather than a cattle boat in CZM???? Call Kim. But do it before you get there... the word will get out and she'll fill up.","Kim truly is a pro. I did my open water dives with her last week. She was prepared, knowledgable, reassuring, relaxed, professional, and funny. The time under and above water with her was great."],l.daysOfTheWeek=[],l.weatherInCity="Current Weather in Cozumel...";var u=["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"];l.weatherDescMap={"clear-day":'<i class="wi wi-day-sunny"></i>',"clear-night":'<i class="wi wi-night-clear"></i>',snow:'<i class="wi wi-snow"></i>',rain:'<i class="wi wi-thunderstorm"></i>',fog:'<i class="wi wi-fog"></i>',cloudy:'<i class="wi wi-cloudy"></i>',wind:'<i class="wi wi-day-windy"></i>',sleet:'<i class="wi wi-sleet"></i>',"partly-cloudy-night":'<i class="wi wi-night-partly-cloudy"></i>',"partly-cloudy-day":'<i class="wi wi-day-cloudy"></i>'},window.sessionStorage.userInfo?this.isLoggedIn=!0:this.isLoggedIn=!1,l.toggleTemperature=function(e){"farenheit"===e?l.tempScale=!0:l.tempScale=!1},r.getWeather().then(function(r){e.currentWeather=r;var t=new Skycons({color:"#999"}),n=r.daily.data,i=1;for(i;i<n.length;i++){var o=new Date(1e3*n[i].time);l.daysOfTheWeek.push({date:u[o.getDay()],weekDay:a(n[i].date),maxtempC:n[i].maxtempC,maxtempF:n[i].temperatureHigh,mintempC:n[i].mintempC,mintempF:n[i].temperatureLow,icon:n[i].icon})}t.set("weatherIcon",e.currentWeather.currently.icon),t.play()}),this.userLogin=function(){e.message="Show Form Button Clicked ONE this happens when user clicks admin login",console.log(e.message);var r=t.open({templateUrl:"/partials/modal/login.html",controller:"LoginCtrl",scope:e});r.result.then(function(e){n.login(e.useremail,e.password);i.path("/admin"),window.location.reload()},function(){$log.info("Modal dismissed at: "+new Date)})},this.userLogout=function(){window.sessionStorage.clear(),i.path("/home"),window.location.reload()}}])}(),function(){"use strict";var e=angular.module("myApp.controller");e.controller("HomeCtrl",["$scope","getWeatherFactory","$window","$uibModal","getImagesFactory",function(e,r,t,n,i){function o(e){var r=e.url;return r=r.replace("dl=0","raw=1")}this.pageIdentifier="Home",this.panelTitle="Explore the Mystical Underwater World of Cozumel with Dive GalaxSea",e.caseData=!1,e.showDiver=!0,i.getGallery().then(function(r){e.showDiver=!1;var t,n=r.links.length,i=[];for(t=0;n>t;t++)if("file"===r.links[t][".tag"]&&-1!==r.links[t].path_lower.search(/\bcarousel\b/)){var s=o(r.links[t]);null!==s&&i.push(s),e.carousel=i}e.caseData=!0}),this.alertType=window.localStorage.alertType,this.alertMsg=window.localStorage.alerts,localStorage.clear()}])}(),function(){"use strict";var e=angular.module("myApp.controller");e.controller("ReefMapCtrl",["$scope",function(e){this.pageIdentifier="Reef Map",this.panelTitle="Don't Imagine Paradise, Visit Cozumel!"}])}(),function(){"use strict";var e=angular.module("myApp.controller");e.controller("CurrentPricingCtrl",["$scope","getPricingFactory","usSpinnerService",function(e,r,t){var n=this;n.showSpinner=!0,n.pageIdentifier="Current Pricing",n.panelTitle="Learn About our Scuba Dive Courses & Diving Rates",n.diving="partials/pricing_partials/diving.html",n.rental="partials/pricing_partials/rental_gear.html",n.training="partials/pricing_partials/training.html",n.policies="partials/pricing_partials/policies.html",r.getDivingPricing().then(function(e){n.currentPricingDiving=e}),r.getTrainingPricing().then(function(e){n.currentPricingTraining=e}),r.getRentalPricing().then(function(e){n.currentPricingRentals=e}),r.getSpecialtiesPricing().then(function(e){n.showSpinner=!1,n.currentPricingSpecialties=e}),r.getMiscellaneousPricing().then(function(e){n.showSpinner=!1;var r=e;n.parkFee=r[0].price})}])}(),function(){"use strict";var e=angular.module("myApp.controller");e.controller("AboutCozumelCtrl",["$scope",function(e){this.pageIdentifier="About Cozumel",this.panelTitle="Go Diving in Cozumel and Explore the Mesmerizing Coral Reefs!"}])}(),function(){"use strict";var e=angular.module("myApp.controller");e.controller("GalleryCtrl",["$scope","$document","$http","getImagesFactory",function(e,r,t,n){function i(e){var r={},t=e.url;return t=t.replace("dl=0","raw=1"),r.thumb=t,r.img=t,r}var o=this;o.pageIdentifier="Gallery",o.panelTitle="Explore the Underwater Galaxy of Cozumel",o.picOfTheMonth={src:"images/img15.jpg",title:"Picture of the Month",description:"Contrats to Judi",user:"Troy Leach"},n.getGallery().then(function(r){var t,n=r.links.length,s=[];for(t=0;n>t;t++)if("file"===r.links[t][".tag"])if(-1!==r.links[t].path_lower.search(/\bgallery\b/)){var c=i(r.links[t]);null!==c&&s.push(c),e.images=s}else if(-1!==r.links[t].path_lower.search(/\bpicture_of_month\b/)){var a=r.links[t].url;a=a.replace("dl=0","raw=1"),o.picOfTheMonth.src=a}})}])}(),function(){"use strict";var e=angular.module("myApp.controller");e.controller("ReservationsCtrl",["$scope","$http","$route","$location","$window","getPricingFactory",function(e,r,t,n,i,o){var s=this;s.showspinner=!1,s.pageIdentifier="Reservations",s.panelTitle="kim@divegalaxsea.com | 52-987-112-9630 | From the US: 011-52-1-987-112-9630",s.checkboxModel=!1,s.user={firstName:void 0,lastName:void 0,email:void 0,selectedDiving:[],selectedTraining:[],selectedDates:[]},s.checkFirst=function(){s.user.selectedDiving.splice(0,s.user.selectedDiving.length),s.user.selectedDiving.push("guest")},o.getDivingPricing().then(function(e){s.diving=e}),o.getTrainingPricing().then(function(e){s.training=e}),o.getRentalPricing().then(function(e){s.rentals=e}),o.getSpecialtiesPricing().then(function(e){s.specialties=e}),s.twoTank=!1,s.reset=function(){s.user={}},s.saveData=function(){s.showspinner=!0;var e={user:{first_name:s.user.firstName,last_name:s.user.lastName,email:s.user.email,phone:s.user.phone,comments:s.user.message,vacations_attributes:[{dates_array:s.user.selectedDates,diving_objects:s.user.selectedDiving,training_objects:s.user.selectedTraining,number_of_divers:s.user.numberOfDivers,resort:s.user.resort}]}};r.post(URL+"users",e).success(function(e,r){s.showSpinner=!1,i.localStorage.setItem("alerts"," I have your information and I will contact you shortly."),i.localStorage.setItem("alertType","Success!"),i.location.href="/"}).error(function(e,r){console.log(r)})},s.addDiving=function(e){s.user.selectedDiving.push(e)},s.activeDate=null,s.selectedDates=[(new Date).setHours(0,0,0,0)],s.type="individual",s.removeFromSelected=function(e){s.user.selectedDates.splice(s.user.selectedDates.indexOf(e),1)},e.roles=["guest","user","customer","admin"],e.user={roles:["user"]},e.checkAll=function(){e.user.roles=angular.copy(e.roles)},e.uncheckAll=function(){e.user.roles=[]},e.checkFirst=function(){e.user.roles.splice(0,e.user.roles.length),e.user.roles.push("guest")}}])}(),function(){"use strict";var e=angular.module("myApp.controller");e.controller("AdminCtrl",["$scope","getWeatherFactory","$window","getPricingFactory","updatePricingFactory","createPricingFactory","deletePricingFactory","$uibModal","$log",function(e,r,t,n,i,o,s,c,a){var l=this;this.pageIdentifier="Admin Dashboard",this.panelTitle="Single Day Rates",l.singleDay="partials/edit_pricing_partials/single_day.html",l.rentalGear="partials/edit_pricing_partials/rental_gear.html",l.training="partials/edit_pricing_partials/training.html",l.specialties="partials/edit_pricing_partials/specialties.html",l.miscellaneous="partials/edit_pricing_partials/miscellaneous_pricings.html",e.editPrice=function(r,t){e.message="Show Form Button Clicked",console.log(e.message),e.pricing_object=r,e.category=t+"Ctrl";var n=c.open({templateUrl:"/partials/modal/edit_single_day_rates.html",controller:e.category,scope:e,resolve:{userForm:function(){return e.userForm}}});n.result.then(function(r){var t={},n={SpecialtiesCtrl:"specialty",TrainingsCtrl:"training",DivingsCtrl:"diving",Miscellaneous_pricingsCtrl:"miscellaneous_pricing",RentalsCtrl:"rental"},o=n[e.category];t.id=r.id,t[o]={title:r.title,price:r.price,description:r.description},"SpecialtiesCtrl"==e.category?i.updateSpecialtiesPricing(t):"TrainingsCtrl"==e.category?i.updateTrainingsPricing(t):"RentalsCtrl"==e.category?i.updateRentalsPricing(t):"DivingsCtrl"==e.category?i.updateDivingsPricing(t):"MiscellaneousCtrl"==e.category&&i.updateMiscellaneousPricing(t)},function(){a.info("Modal dismissed at: "+new Date)})},e.deletePrice=function(r,t){s.deletePricing(r,t),e.getData()},e.newPrice=function(r,t){e.message="Upon a new action",console.log(e.message),e.pricing_object=r,e.action=t.toLowerCase(),e.category=t+"Ctrl";var n=c.open({templateUrl:"/partials/modal/edit_single_day_rates.html",controller:e.category,scope:e,resolve:{userForm:function(){return e.userForm}}});n.result.then(function(r){var t={},n={SpecialtiesCtrl:"specialty",TrainingsCtrl:"training",DivingsCtrl:"diving",Miscellaneous_pricingsCtrl:"miscellaneous_pricing",RentalsCtrl:"rental"},i=n[e.category];t.id=r.id,t[i]={title:r.title,price:r.price,description:r.description},o.createPricing(t,e.action)},function(){a.info("Modal dismissed at: "+new Date)})},e.getData=function(){n.getDivingPricing().then(function(e){l.currentPricingDiving=e}),n.getTrainingPricing().then(function(e){l.currentPricingTraining=e}),n.getRentalPricing().then(function(e){l.currentPricingRentals=e}),n.getSpecialtiesPricing().then(function(e){l.currentPricingSpecialties=e}),n.getMiscellaneousPricing().then(function(e){l.currentPricingMiscellaneous=e})},e.getData()}])}(),function(){"use strict";var e=angular.module("myApp.controller");e.controller("SpecialtiesCtrl",["$scope","$modalInstance","userForm",function(e,r,t,n){e.pricing=e.pricing_object,e.submitForm=function(){e.form.userForm.$valid?(console.log("user form is in scope"),r.close(e.pricing)):console.log("userform is not in scope")},e.cancel=function(){r.dismiss("cancel")}}])}(),function(){"use strict";var e=angular.module("myApp.controller");e.controller("TrainingsCtrl",["$scope","$modalInstance","userForm",function(e,r,t,n){e.pricing=e.pricing_object,e.submitForm=function(){e.form.userForm.$valid?(console.log("user form is in scope"),r.close(e.pricing)):console.log("userform is not in scope")},e.cancel=function(){r.dismiss("cancel")}}])}(),function(){"use strict";var e=angular.module("myApp.controller");e.controller("RentalsCtrl",["$scope","$modalInstance","userForm",function(e,r,t,n){e.pricing=e.pricing_object,e.submitForm=function(){e.form.userForm.$valid?(console.log("user form is in scope"),r.close(e.pricing)):console.log("userform is not in scope")},e.cancel=function(){r.dismiss("cancel")}}])}(),function(){"use strict";var e=angular.module("myApp.controller");e.controller("DivingsCtrl",["$scope","$modalInstance","userForm",function(e,r,t,n){e.pricing=e.pricing_object,e.submitForm=function(){e.form.userForm.$valid?(console.log("user form is in scope"),r.close(e.pricing)):console.log("userform is not in scope")},e.cancel=function(){r.dismiss("cancel")}}])}(),function(){"use strict";var e=angular.module("myApp.controller");e.controller("Miscellaneous_pricingsCtrl",["$scope","$modalInstance","userForm",function(e,r,t,n){e.pricing=e.pricing_object,e.submitForm=function(){e.form.userForm.$valid?(console.log("user form is in scope"),r.close(e.pricing)):console.log("userform is not in scope")},e.cancel=function(){r.dismiss("cancel")}}])}(),function(){"use strict";var e=angular.module("myApp.controller");e.controller("LoginCtrl",["$scope","$modalInstance","AuthenticationService","$window",function(e,r,t,n,i){e.submit=function(){e.loginForm.$valid?r.close(e.credentials):console.log("userform is not in scope")},e.cancel=function(){r.dismiss("cancel")}}])}(),function(){"use strict";var e=angular.module("myApp.services",[]);e.factory("getWeatherFactory",["$http","$q",function(e,r){var t={};return{devGetWeather:function(){var t=r.defer();return e.get("./scripts/services/fakePayload.json").then(function(e){t.resolve(e.data)}),t.promise},getWeather:function(){var n=20.423,i=-86.9223,o=DARK_SKY_KEY+DARK_SKY_API_KEY+"/"+n+","+i,s=r.defer();return e.get(o).success(function(e){t.currently=e.currently,t.daily=e.daily,s.resolve(t)}).error(function(e){console.log("Could not make this request",e),s.reject()}),s.promise}}}])}.call(this),function(){"use strict";var e=angular.module("myApp.services");e.factory("getPricingFactory",["$http","$q",function(e,r){return{getDivingPricing:function(){var t=r.defer();return e.get(URL+"divings",HEADERS).success(function(e){t.resolve(e)}).error(function(){t.reject()}),t.promise},getTrainingPricing:function(){var t=r.defer();return e.get(URL+"trainings",HEADERS).success(function(e){t.resolve(e)}).error(function(){t.reject()}),t.promise},getRentalPricing:function(){var t=r.defer();return e.get(URL+"rentals",HEADERS).success(function(e){t.resolve(e)}).error(function(){t.reject()}),t.promise},getSpecialtiesPricing:function(){var t=r.defer();return e.get(URL+"specialties",HEADERS).success(function(e){t.resolve(e)}).error(function(){t.reject()}),t.promise},getMiscellaneousPricing:function(){var t=r.defer();return e.get(URL+"miscellaneous_pricings",HEADERS).success(function(e){t.resolve(e)}).error(function(){t.reject()}),t.promise}}}])}.call(this),function(){"use strict";var e=angular.module("myApp.services");e.factory("updatePricingFactory",["$http","$q",function(e,r){return{updateDivingsPricing:function(t){var n=r.defer();return e.patch(URL+"divings/"+t.id,t,HEADERS).success(function(e){n.resolve(e)}).error(function(){n.reject()}),n.promise},updateRentalsPricing:function(t){var n=r.defer();return e.patch(URL+"rentals/"+t.id,t,HEADERS).success(function(e){n.resolve(e)}).error(function(){n.reject()}),n.promise},updateTrainingsPricing:function(t){var n=r.defer();return e.patch(URL+"trainings/"+t.id,t,HEADERS).success(function(e){n.resolve(e)}).error(function(){n.reject()}),n.promise},updateSpecialtiesPricing:function(t){var n=r.defer();return e.patch(URL+"specialties/"+t.id,t,HEADERS).success(function(e){n.resolve(e)}).error(function(){n.reject()}),n.promise},updateMiscellaneousPricing:function(t){var n=r.defer();return e.patch(URL+"miscellaneous_pricings/"+t.id,t,HEADERS).success(function(e){n.resolve(e)}).error(function(){n.reject()}),n.promise}}}])}.call(this),function(){"use strict";var e=angular.module("myApp.services");e.factory("createPricingFactory",["$http","$q",function(e,r){return{createPricing:function(t,n){var i=r.defer();return e.post(URL+n+"/",t,HEADERS).success(function(e){i.resolve(e)}).error(function(){i.reject()}),i.promise},createDivingsPricing:function(t){var n=r.defer();return e.post(URL+"divings/",t,HEADERS).success(function(e){n.resolve(e)}).error(function(){n.reject()}),n.promise},createRentalsPricing:function(t){var n=r.defer();return e.post(URL+"rentals/",t,HEADERS).success(function(e){n.resolve(e)}).error(function(){n.reject()}),n.promise},createTrainingsPricing:function(t){var n=r.defer();return e.post(URL+"trainings/",t,HEADERS).success(function(e){n.resolve(e)}).error(function(){n.reject()}),n.promise},createSpecialtiesPricing:function(t){var n=r.defer();return e.post(URL+"specialties/",t,HEADERS).success(function(e){n.resolve(e)}).error(function(){n.reject()}),n.promise},createMiscellaneousPricing:function(t){var n=r.defer();return e.post(URL+"miscellaneous_pricings/",t,HEADERS).success(function(e){n.resolve(e)}).error(function(){n.reject()}),n.promise}}}])}.call(this),function(){"use strict";var e=angular.module("myApp.services");e.factory("deletePricingFactory",["$http","$q",function(e,r){return{deletePricing:function(t,n){var i=r.defer(),o=URL+n+"/"+t.id;return e["delete"](o,HEADERS).success(function(e){i.resolve(e)}).error(function(){i.reject()}),i.promise}}}])}.call(this),function(){"use strict";var e=angular.module("myApp.services");e.factory("AuthenticationService",["$http","$q","$window",function(e,r,t){function n(n,i){var o=r.defer(),s={users_information:{email:n,password:i}};return e.post(URL+"login",s,HEADERS).success(function(e){c={accessToken:e.access_token},t.sessionStorage.userInfo=JSON.stringify(c),o.resolve(c)},function(e){window.localStorage.alerts="Not a Authorized Diver",window.localStorage.alertType="alert-danger",o.reject(e)}),o.promise}function i(){var n=r.defer();return e({method:"POST",url:URL+"logout",headers:{access_token:c.accessToken}}).then(function(e){c=null,t.sessionStorage.userInfo=null,n.resolve(e)},function(e){n.reject(e)}),n.promise}function o(){return c}function s(){t.sessionStorage.userInfo&&(c=JSON.parse(t.sessionStorage.userInfo))}var c;return s(),{login:n,logout:i,getUserInfo:o}}])}.call(this),function(){"use strict";var e=angular.module("myApp.services");e.factory("getImagesFactory",["$http","$q",function(e,r){return{getGallery:function(){var t=r.defer();return e({url:"https://api.dropboxapi.com/2/sharing/list_shared_links",method:"POST",data:"{}",headers:{Authorization:"Bearer "+DB_ACCESS_TOKEN,"Content-Type":"application/json"}}).success(function(e,r,n,i){t.resolve(e)}).error(function(e,r,n,i){console.log(e),t.reject()}),t.promise}}}])}.call(this),function(){"use strict";var e=angular.module("myApp.directives",[]);e.directive("sampleDirective",["$scope",function(e){return{restrict:"E",transclude:!0,scope:{},controller:function(e){},link:function(e,r,t){},replace:!0,templateUrl:""}}])}(),function(){"use strict";var e=angular.module("myApp.filters",[]);e.filter("simpleFilter",function(){return function(e){try{}catch(r){console.log("utcToDate :::::: ERROR: "+r)}return e}})}(),function(){"use strict";var e=angular.module("myApp.constants",[]);e.constant("liaisonConstants",{appName:"Liaison My Psych Track",loginErrorUsernamePassword:"You must enter username and password to log in",loginErrorInvalidCredentials:"Invalid credentials,Try Again!"})}(),function(){"use strict";var e=angular.module("myApp.utilityService",[]);e.service("utilService",["$timeout",function(e){this.showLoader=function(){e(function(){},2e3)},this.dismissProgress=function(){e(function(){},2e3)}}])}(),$(document).ready(function(){$(".picture-carousel").slick({autoplay:!0}),$(".autoplay").slick({slidesToShow:1,slidesToScroll:1,autoplay:!0,autoplaySpeed:2e3})});